<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>æœºå™¨å­¦ä¹ å®è·µ - Learning Programming Book</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The example book covers examples.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/pagetoc.css">
        <!-- MathJax -->
        <!-- <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        <script async type="text/javascript" src="theme/MathJax.js"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../prefix.html">Prefix</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ç¨‹åºè®¾è®¡è¯­è¨€</li><li class="chapter-item expanded "><a href="../Python/Pythonç¼–ç¨‹åŸºç¡€.html">Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Python/Pythonç¼–ç¨‹åŸºç¡€.html">ç¼–ç¨‹åŸºç¡€</a></li><li class="chapter-item expanded "><a href="../Python/Pythonå¼€å‘ç¯å¢ƒ.html">å¼€å‘ç¯å¢ƒ</a></li><li class="chapter-item expanded "><a href="../Python/Pythonæ•°æ®ç±»å‹.html">æ•°æ®ç±»å‹</a></li><li class="chapter-item expanded "><a href="../Python/Pythonè¾“å…¥è¾“å‡º.html">è¾“å…¥è¾“å‡º</a></li><li class="chapter-item expanded "><a href="../Python/Pythonç¼–ç¨‹åº”ç”¨.html">ç¼–ç¨‹åº”ç”¨</a></li><li class="chapter-item expanded "><a href="../Python/Pythonæ•°å€¼è®¡ç®—.html">æ•°å€¼è®¡ç®—</a></li><li class="chapter-item expanded "><a href="../Python/Pythonç³»ç»Ÿç¼–ç¨‹.html">ç³»ç»Ÿç¼–ç¨‹</a></li><li class="chapter-item expanded "><a href="../Python/Pythoné«˜çº§ç¼–ç¨‹.html">é«˜çº§ç¼–ç¨‹</a></li></ol></li><li class="chapter-item expanded "><a href="../Java/JAVAç¼–ç¨‹åŸºç¡€.html">Java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Java/JAVAç¼–ç¨‹åŸºç¡€.html">ç¼–ç¨‹åŸºç¡€</a></li><li class="chapter-item expanded "><a href="../Java/Javaå¼€å‘ç¯å¢ƒ.html">å¼€å‘ç¯å¢ƒ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Java/Maven POM.html">Maven é…ç½®</a></li></ol></li><li class="chapter-item expanded "><a href="../Java/JAVAæ•°æ®ç±»å‹.html">æ•°æ®ç±»å‹</a></li><li class="chapter-item expanded "><a href="../Java/JAVAè¾“å…¥è¾“å‡º.html">è¾“å…¥è¾“å‡º</a></li><li class="chapter-item expanded "><a href="../Java/JAVAç³»ç»Ÿç¼–ç¨‹.html">ç³»ç»Ÿç¼–ç¨‹</a></li><li class="chapter-item expanded "><a href="../Java/Scala.html">Scala</a></li><li class="chapter-item expanded "><a href="../Java/ScalaFrameworks.html">Scala æ¡†æ¶</a></li></ol></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharpç¼–ç¨‹åŸºç¡€.html">C#/.NET</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CSharp.NET/CSharpç¼–ç¨‹åŸºç¡€.html">ç¼–ç¨‹åŸºç¡€</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharpè¾“å…¥è¾“å‡º.html">è¾“å…¥è¾“å‡º</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharpæ•°æ®å®¹å™¨.html">æ•°æ®å®¹å™¨</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharpæ•°å€¼è®¡ç®—.html">æ•°å€¼è®¡ç®—</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/dotnetå¼€å‘.html">.NET å¼€å‘</a></li></ol></li><li class="chapter-item expanded "><a href="../CC++/Modern C++.html">C and C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CC++/Modern C++.html">Modern C++</a></li><li class="chapter-item expanded "><a href="../CC++/C++å¼€å‘ç¯å¢ƒ.html">å¼€å‘ç¯å¢ƒ</a></li><li class="chapter-item expanded "><a href="../CC++/C++å®¹å™¨.html">æ•°æ®å®¹å™¨</a></li><li class="chapter-item expanded "><a href="../CC++/è¾“å…¥è¾“å‡º.html">è¾“å…¥è¾“å‡º</a></li><li class="chapter-item expanded "><a href="../CC++/æ ‡å‡†å‡½æ•°åº“.html">æ ‡å‡†åº“</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CC++/æ•°å­¦å‡½æ•°.html">æ•°å­¦å‡½æ•°</a></li></ol></li></ol></li><li class="chapter-item expanded "><div>Webå¼€å‘</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../JavaScript/JavaScript.html">JavaScript</a></li><li class="chapter-item expanded "><a href="../JavaScript/TypeScript.html">TypeScript</a></li><li class="chapter-item expanded "><a href="../JavaScript/JSå¼€å‘ç¯å¢ƒ.html">å¼€å‘ç¯å¢ƒ</a></li></ol></li><li class="chapter-item expanded "><div>å¼€å‘å·¥å…·</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../å¼€å‘ç¯å¢ƒ/git.html">Git</a></li><li class="chapter-item expanded "><a href="../ç¬”è®°/æ­£åˆ™è¡¨è¾¾å¼.html">æ­£åˆ™è¡¨è¾¾å¼</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">æ“ä½œç³»ç»Ÿ</li><li class="chapter-item expanded "><a href="../Linux/Linuxé…ç½®å’Œç®¡ç†.html">Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Linux/Linuxé…ç½®å’Œç®¡ç†.html">é…ç½®ç®¡ç†</a></li><li class="chapter-item expanded "><a href="../Linux/Linux-Shell.html">Shell Script</a></li><li class="chapter-item expanded "><a href="../Linux/Linuxå‘è¡Œç‰ˆ.html">Linux å‘è¡Œç‰ˆ</a></li><li class="chapter-item expanded "><a href="../Linux/æ“ä½œç³»ç»ŸåŸç†.html">æ“ä½œç³»ç»ŸåŸç†</a></li></ol></li><li class="chapter-item expanded "><a href="../Windows/Windowsé…ç½®ç®¡ç†.html">Windows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Windows/Windowsé…ç½®ç®¡ç†.html">é…ç½®ç®¡ç†</a></li><li class="chapter-item expanded "><a href="../Windows/Windows Shell.html">Shell</a></li><li class="chapter-item expanded "><a href="../Windows/Windows Applications.html">åº”ç”¨è½¯ä»¶</a></li></ol></li><li class="chapter-item expanded "><div>åº”ç”¨è½¯ä»¶</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/ç¨‹åºå¼€å‘è½¯ä»¶.html">ç¨‹åºå¼€å‘</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/æœåŠ¡å™¨ç®¡ç†è½¯ä»¶.html">æœåŠ¡å™¨ç®¡ç†</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/ç½‘ç»œè®¿é—®è½¯ä»¶.html">ç½‘ç»œè®¿é—®</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/ç½‘ç»œæœåŠ¡è½¯ä»¶.html">ç½‘ç»œæœåŠ¡</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/æ–‡æ¡£ç”Ÿæˆè½¯ä»¶.html">æ–‡æ¡£ç”Ÿæˆ</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/æ–‡ä»¶å¤„ç†è½¯ä»¶.html">æ–‡ä»¶å¤„ç†</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/åä½œåŠå…¬è½¯ä»¶.html">åä½œåŠå…¬</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/çŸ¥è¯†ç®¡ç†è½¯ä»¶.html">çŸ¥è¯†ç®¡ç†</a></li><li class="chapter-item expanded "><a href="../åº”ç”¨è½¯ä»¶/å¤šåª’ä½“ç¼–è¾‘è½¯ä»¶.html">å¤šåª’ä½“ç¼–è¾‘</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">æœºå™¨å­¦ä¹ </li><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /æœºå™¨å­¦ä¹ å®è·µ.html" class="active">æœºå™¨å­¦ä¹ å®è·µ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /ScikitLearn.html">scikit-learn</a></li><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /TensorFlow.html">TensorFlow</a></li><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /Pytorch.html">Pytorch</a></li><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /å›¾ç¥ç»ç½‘ç»œ.html">å›¾ç¥ç»ç½‘ç»œ</a></li></ol></li><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /æœºå™¨å­¦ä¹ åŸç†ä¸ç®—æ³•.html">åŸç†ä¸ç®—æ³•</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æœºå™¨å­¦ä¹ /ç»Ÿè®¡å­¦ä¹ ç®—æ³•.html">ç»Ÿè®¡å­¦ä¹ ç®—æ³•</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">æ•°æ®åº“</li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/SQLè¯­æ³•.html">SQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æ•°æ®åº“/SQL DDL.html">SQL DDL</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/SQL DML.html">SQL DML</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/SQLæ•°æ®ç±»å‹.html">æ•°æ®ç±»å‹</a></li></ol></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/MySQL.html">MySQL</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/PostgreSQL.html">PostgreSQL</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/HiveSQL.html">Hive SQL</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/Elasticsearch.html">Elasticsearch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æ•°æ®åº“/Elastic Datasource.html">æ•°æ®æº</a></li></ol></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/Mongodb.html">Mongodb</a></li><li class="chapter-item expanded "><a href="../æ•°æ®åº“/GraphDatabase.html">å›¾æ•°æ®åº“</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">æœåŠ¡å’Œå¤§æ•°æ®å¹³å°</li><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/åˆ†å¸ƒå¼å¤§æ•°æ®å¤„ç†.html">åˆ†å¸ƒå¼å¤§æ•°æ®å¤„ç†</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/CDH6å¤§æ•°æ®é›†ç¾¤ç¦»çº¿å®‰è£….html">CDH6 å®‰è£…æ•™ç¨‹</a></li><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/Spark Python API.html">Pyspark</a></li><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/æµæ•°æ®å¤„ç†.html">æµæ•°æ®å¤„ç†</a></li></ol></li><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/å®¹å™¨ç¼–æ’.html">å®¹å™¨ç¼–æ’</a></li><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/è™šæ‹ŸåŒ–.html">è™šæ‹ŸåŒ–</a></li><li class="chapter-item expanded "><div>ä»»åŠ¡ç¼–æ’</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æœåŠ¡å™¨/Airflow.html">Airflow</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">å…¶ä»–</li><li class="chapter-item expanded "><div>æ•°æ®æ ‡è®°è¯­è¨€</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../æ•°æ®äº¤æ¢è¯­è¨€/JSON and YAML.html">JSON and YAML</a></li><li class="chapter-item expanded "><a href="../æ•°æ®äº¤æ¢è¯­è¨€/XML.html">XML</a></li><li class="chapter-item expanded "><a href="../æ•°æ®äº¤æ¢è¯­è¨€/HTML.html">HTML</a></li></ol></li><li class="chapter-item expanded "><div>ç½‘ç»œåè®®</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Protocols/http.html">HTTP</a></li><li class="chapter-item expanded "><a href="../Protocols/DNS.html">DNS</a></li><li class="chapter-item expanded "><a href="../Protocols/ç«¯å£åˆ†é….html">ç«¯å£åˆ†é…</a></li><li class="chapter-item expanded "><a href="../Protocols/IP protocol numbers.html">IP æ‰¿è½½åè®®</a></li><li class="chapter-item expanded "><a href="../Protocols/RPC.html">RPC</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Learning Programming Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <h1 id="æœºå™¨å­¦ä¹ å®è·µ"><a class="header" href="#æœºå™¨å­¦ä¹ å®è·µ">æœºå™¨å­¦ä¹ å®è·µ</a></h1>
<h2 id="æ­å»ºå¼€å‘ç¯å¢ƒ"><a class="header" href="#æ­å»ºå¼€å‘ç¯å¢ƒ">æ­å»ºå¼€å‘ç¯å¢ƒ</a></h2>
<h3 id="pythonç¯å¢ƒ"><a class="header" href="#pythonç¯å¢ƒ">Pythonç¯å¢ƒ</a></h3>
<p>æ•°æ®å¤„ç†å’Œç®—æ³•åº“ï¼š</p>
<ul>
<li><code>numpy</code>ã€<code>pandas</code>ï¼›</li>
<li><code>scipy</code>ã€sklearn (<code>scikit-learn</code>)</li>
<li><code>tensorflow</code>ã€<code>keras</code>ï¼ˆ<code>tensorflow</code>å·²å°†<code>keras</code>ä½œä¸ºå†…ç½®æ¨¡å—ï¼Œä½†ä½¿ç”¨éœ€è¦å•ç‹¬å®‰è£…ï¼‰ï¼›</li>
<li><code>pytorch</code>ï¼›</li>
</ul>
<h4 id="å®‰è£…tensorflow"><a class="header" href="#å®‰è£…tensorflow">å®‰è£…Tensorflow</a></h4>
<p><code>tensorflow 1.x</code>åˆ†ä¸ºCPUå’ŒGPUç‰ˆæœ¬ï¼Œä¸”<code>1.x</code>å’Œ<code>2.x</code>ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œå› æ­¤éœ€è¦åœ¨å•ç‹¬çš„è™šæ‹Ÿç¯å¢ƒä¸­åˆ†åˆ«å®‰è£…ï¼š</p>
<pre><code class="language-shell">conda create -n tf2 [tensorflow-gpu] tensorflow=&lt;ver&gt; cudnn cudatoolkit=11.2 keras
conda create -n tfgpu tensorflow-gpu=&lt;ver&gt; ... # 1.x GPUç‰ˆæœ¬
</code></pre>
<blockquote>
<p>2.xç‰ˆæœ¬çš„åŒ…åä¸åŒºåˆ†GPU/CPUç‰ˆæœ¬ï¼Œæ ¹æ®æ˜¯å¦å®‰è£…GPUå·¥å…·åŒ…ï¼ˆ<code>cudnn</code>å’Œ<code>cudatoolkit</code>ï¼‰å†³å®šæ˜¯å¦èƒ½ä½¿ç”¨GPUè®¡ç®—ã€‚<code>tensorflow-gpu</code>å£°æ˜äº†å¯¹GPUåº“çš„ä¾èµ–ä¿è¯å®‰è£…æ”¯æŒGPUçš„ç‰ˆæœ¬ã€‚</p>
<p>ä½¿ç”¨<code>pip</code>å®‰è£…ï¼š</p>
<pre><code class="language-shell">pip install tensorflow    # CPU ç‰ˆæœ¬
</code></pre>
</blockquote>
<h5 id="gpuæ”¯æŒ"><a class="header" href="#gpuæ”¯æŒ">GPUæ”¯æŒ</a></h5>
<p>åœ¨ç³»ç»Ÿä¸­å®‰è£…<a href="https://www.nvidia.com/drivers">NVIDIAÂ® GPU é©±åŠ¨ç¨‹åº</a>ï¼ˆCUDA 11.2éœ€è¦450.80.02æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚==ä½¿ç”¨Condaå®‰è£…<code>tensorflow-gpu</code>å°†è‡ªåŠ¨ä¸ºè™šæ‹Ÿç¯å¢ƒå®‰è£…å…¼å®¹ç‰ˆæœ¬çš„CUDA Toolkitå’ŒcuDNN==ã€‚å®˜æ–¹æä¾›CUDA ToolkitåŒ…å«äº†è¿›è¡ŒCUDAç›¸å…³ç¨‹åºå¼€å‘çš„ç¼–è¯‘ã€è°ƒè¯•ç­‰è¿‡ç¨‹ç›¸å…³çš„æ‰€æœ‰ç»„ä»¶ã€‚è€ŒCondaè™šæ‹Ÿç¯å¢ƒæä¾›çš„CUDA Toolkitä»…åŒ…å«è¿è¡Œæ—¶åº“ã€‚ä»¥ä¸‹ä¸ºå¯é€‰å®‰è£…å†…å®¹ï¼š</p>
<ul>
<li>
<p><a href="https://developer.nvidia.com/cuda-toolkit-archive">CUDAÂ® å·¥å…·åŒ…</a>ï¼ˆCUDA Toolkitï¼‰ï¼šTensorFlow æ”¯æŒ CUDA 11.2ï¼ˆTensorFlow 2.5.0åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚ </p>
</li>
<li>
<p><a href="https://developer.nvidia.com/cudnn">cuDNN SDK</a>ï¼ˆ8.1.0ï¼‰</p>
</li>
<li>
<p>CUDA å·¥å…·åŒ…é™„å¸¦çš„ <a href="http://docs.nvidia.com/cuda/cupti/">CUPTI</a>ã€‚</p>
<pre><code class="language-shell">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/extras/CUPTI/lib64
</code></pre>
</li>
<li>
<p><a href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html">TensorRT 6.0</a>ï¼Œå¯ç¼©çŸ­ç”¨æŸäº›æ¨¡å‹è¿›è¡Œæ¨æ–­çš„å»¶è¿Ÿæ—¶é—´å¹¶æé«˜ååé‡ã€‚</p>
</li>
</ul>
<h5 id="tensorflowå®¹å™¨"><a class="header" href="#tensorflowå®¹å™¨"><a href="https://hub.docker.com/r/tensorflow/tensorflow/">TensorFlowå®¹å™¨</a></a></h5>
<pre><code class="language-shell">docker run -it -p 8888:8888 tensorflow/tensorflow:latest-jupyter
</code></pre>
<p><a href="https://www.tensorflow.org/install/docker">Docker  | TensorFlow</a></p>
<h5 id="éªŒè¯å®‰è£…"><a class="header" href="#éªŒè¯å®‰è£…">éªŒè¯å®‰è£…</a></h5>
<pre><code class="language-python">import tensorflow as tf
print(tf.version.VERSION)
tf.config.list_physical_devices()
</code></pre>
<h5 id="tensorflow-with-directml-on-wsl"><a class="header" href="#tensorflow-with-directml-on-wsl"><a href="https://docs.microsoft.com/en-us/windows/ai/directml/gpu-tensorflow-wsl">Tensorflow with DirectML on WSL</a></a></h5>
<h4 id="å®‰è£…pytorch"><a class="header" href="#å®‰è£…pytorch">å®‰è£…PyTorch</a></h4>
<p>ä½¿ç”¨Condaå®‰è£…<code>pytorch</code>ï¼šç›¸å…³åŒ…å¯ä½¿ç”¨<code>pytorch</code>é€šé“ä¸‹è½½ï¼ˆæ³¨æ„<a href="https://pytorch.org/get-started/locally/">é€‰æ‹©æ“ä½œç³»ç»Ÿå’Œè®¡ç®—å¹³å°</a>ï¼Œä»¥ä¸‹ä»…ä¸ºç¤ºä¾‹ï¼‰ã€‚</p>
<pre><code class="language-shell">conda create -n pytorch[-gpu] python=3.8   # python&gt;=3.6
conda install pytorch torchvision torchaudio cpuonly -c pytorch
conda install pytorch=&quot;1.10.*&quot;=&quot;*cuda*&quot; torchvision torchaudio cudatoolkit=11.3 -c pytorch
</code></pre>
<blockquote>
<p>2022/01/21ï¼š<code>conda-forge: cudatoolkit&lt;=11.2</code>ï¼›<code>pytorch: cudatoolkit&lt;=11.3</code>ã€‚å½“Pytorchå’ŒTensorFlowå…±åŒå®‰è£…æ—¶ï¼Œå¯èƒ½å¯¼è‡´ä¾èµ–è§£æé—®é¢˜æ— æ³•å®‰è£…Pytorchçš„GPUç‰ˆæœ¬ï¼Œæ­¤æ—¶å¯æŒ‡å®šå®‰è£…<code>pytorch-gpu</code>ï¼ˆLinuxä¸‹æ‰æœ‰æ­¤åŒ…ï¼‰ã€‚</p>
<p>ä½¿ç”¨pipå®‰è£…<code>pytorch</code>ï¼š </p>
<pre><code class="language-shell">pip install torch torchvision torchaudio           # CPU version
pip3 install torch==1.10.1+cu113 \
  torchvision==0.11.2+cu113 torchaudio==0.10.1+cu113 \
  -f https://download.pytorch.org/whl/cu113/torch_stable.html # GPU version
</code></pre>
<p>éªŒè¯å®‰è£…ï¼š</p>
<pre><code class="language-python">import torch
x = torch.rand(5, 3); print(x)
torch.cuda.is_available()
</code></pre>
</blockquote>
<h5 id="enable-pytorch-with-directml-on-wsl-2"><a class="header" href="#enable-pytorch-with-directml-on-wsl-2"><a href="https://docs.microsoft.com/en-us/windows/ai/directml/gpu-pytorch-wsl">Enable PyTorch with DirectML on WSL 2</a></a></h5>
<h4 id="å›¾ç¥ç»ç½‘ç»œåº“"><a class="header" href="#å›¾ç¥ç»ç½‘ç»œåº“">å›¾ç¥ç»ç½‘ç»œåº“</a></h4>
<h5 id="dgl"><a class="header" href="#dgl">DGL</a></h5>
<pre><code class="language-shell">conda create -n dgl -c pytorch pytorch=1.12 cudatoolkit=11.6 cudnn
conda activate dgl
conda install -c dglteam dgl-cuda11.6
</code></pre>
<p><code>dglteam</code>ä»“åº“ä»…åœ¨Anacondaå®˜æ–¹æºä¸­å¯ç”¨ï¼Œå¦‚æœä½¿ç”¨Nexusä»£ç†ï¼Œå¢åŠ ä»¥ä¸‹ä»“åº“ä»£ç†ã€‚</p>
<pre><code class="language-ini">Name=anaconda-cloud
Remote=https://conda.anaconda.org/
URL=http://192.168.178.52:8081/repository/anaconda-cloud
</code></pre>
<p>ä¹Ÿå¯ä½¿ç”¨DGLæä¾›çš„pipä»“åº“å®‰è£…<code>dgl</code>åº“ã€‚</p>
<pre><code class="language-shell">pip install dgl-cu116 dglgo -f https://data.dgl.ai/wheels/repo.html
</code></pre>
<p>é€šè¿‡é…ç½®æ–‡ä»¶<code>~/.dgl/config.json </code>æˆ–ç¯å¢ƒå˜é‡æŒ‡å®šä½¿ç”¨çš„æ·±åº¦å­¦ä¹ æ¡†æ¶åç«¯ã€‚</p>
<pre><code class="language-json">{
    &quot;backend&quot;:  &quot;pytorch&quot;
}
</code></pre>
<pre><code class="language-shell">export DGLBACKEND=pytorch  # pytorch, mxnet, tensorflow
</code></pre>
<h5 id="pytorch-geometric"><a class="header" href="#pytorch-geometric">PyTorch Geometric</a></h5>
<blockquote>
<p><em><strong>PyG</strong> (PyTorch Geometric) is a library built upon PyTorch to easily write and train Graph Neural Networks (GNNs) for a wide range of applications related to structured data.</em></p>
</blockquote>
<pre><code class="language-shell">conda create -n pyg -c pytorch pytorch=1.12 cudatoolkit=11.6 cudnn
conda activate pyg
conda install pyg -c pyg
</code></pre>
<p>ä½¿ç”¨<code>pip</code>å®‰è£…ï¼š</p>
<pre><code class="language-shell">CUDA={cpu|cu102|cu113|cu116}
pip install torch-scatter -f https://data.pyg.org/whl/torch-1.12.0+${CUDA}.html
pip install torch-sparse -f https://data.pyg.org/whl/torch-1.12.0+${CUDA}.html
pip install torch-geometric
</code></pre>
<div class="table-wrapper"><table><thead><tr><th></th><th><code>cpu</code></th><th><code>cu102</code></th><th><code>cu113</code></th><th><code>cu116</code></th></tr></thead><tbody>
<tr><td><strong>Linux</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>Windows</strong></td><td>âœ…</td><td></td><td>âœ…</td><td>âœ…</td></tr>
<tr><td><strong>macOS</strong></td><td>âœ…</td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p><a href="https://github.com/pyg-team/pytorch_geometric">pyg-team/pytorch_geometric: Graph Neural Network Library for PyTorch (github.com)</a></p>
<h3 id="gpuè®¡ç®—åº“"><a class="header" href="#gpuè®¡ç®—åº“">GPUè®¡ç®—åº“</a></h3>
<h4 id="nvidia-cuda"><a class="header" href="#nvidia-cuda">NVIDIA CUDA</a></h4>
<p>å®‰è£…ï¼š<code>./cuda-xxx.run --no-opengl-libs</code>ï¼›</p>
<p>å¦‚æœæœºå™¨å·²ç»å®‰è£…é©±åŠ¨ç¨‹åºï¼Œåˆ™å®‰è£…è¿‡ç¨‹ä¸­å¯è·³è¿‡é©±åŠ¨ç¨‹åºå®‰è£…ï¼›</p>
<p>ä¿®æ”¹ç¯å¢ƒå˜é‡ä½¿CUDAå…¨å±€å¯ç”¨ï¼›<img src="æœºå™¨å­¦ä¹ å®è·µ.assets/wsl-launch-upt-0625-rz.png" alt="CUDA on WSL Overview." style="zoom:35%;float:right" /></p>
<h5 id="cuda-on-wsl-2"><a class="header" href="#cuda-on-wsl-2">CUDA on WSL 2</a></h5>
<blockquote>
<p>ç³»ç»Ÿç‰ˆæœ¬éœ€è¦ä¸º<a href="https://docs.microsoft.com/en-us/windows/ai/directml/gpu-cuda-in-wsl">Windows 10 21H2æˆ–æ›´é«˜</a>ï¼ŒWSLå‘è¡Œç‰ˆä½¿ç”¨Ubuntuæˆ–Debianï¼ˆLinux 5.10.43.3+ï¼‰ã€‚</p>
</blockquote>
<ol>
<li>
<p>åœ¨Windowsä¸­å®‰è£…<a href="https://developer.nvidia.com/cuda/wsl">æ”¯æŒWSLçš„NVIDIA CUDAé©±åŠ¨ç¨‹åº</a>ã€‚</p>
</li>
<li>
<p>[å¯é€‰] åœ¨WSLä¸­å®‰è£…<a href="https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;target_arch=x86_64&amp;Distribution=WSL-Ubuntu&amp;target_version=2.0">ä¸“ç”¨CUDAå·¥å…·åŒ…</a>ï¼ˆæ³¨æ„ä½¿ç”¨<code>run</code>æ–‡ä»¶ä¸è¦å®‰è£…æ˜¾å¡é©±åŠ¨ï¼‰ï¼›å¦‚æœéœ€è¦<a href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html#ch03a-setting-up-cuda">ç¼–è¯‘CUDAç¨‹åº</a>ï¼Œåˆ™éœ€è¦å®‰è£…CUDA Toolkitã€‚</p>
</li>
<li>
<p>ä½¿ç”¨CUDAè‡ªå¸¦æ ·ä¾‹éªŒè¯å®‰è£…æ˜¯å¦æ­£ç¡®ï¼›</p>
</li>
<li>
<p>å®‰è£…å®Œæˆåï¼Œå³å¯å’Œæ™®é€šLinuxä¸€æ ·ä½¿ç”¨PyTorchã€TensorFlowæˆ–<a href="https://github.com/NVIDIA/nvidia-docker">NVIDIA Docker</a>ã€‚</p>
<pre><code class="language-shell"># éªŒè¯
nvidia-smi -q
chmod -R a+w /usr/local/cuda-11.4/samples
cd /usr/local/cuda-11.4/samples/4_Finance/BlackScholes
make BlackScholes &amp;&amp; ./BlackScholes
</code></pre>
</li>
</ol>
<h4 id="nvidia-docker"><a class="header" href="#nvidia-docker">NVIDIA Docker</a></h4>
<blockquote>
<p>Note that NVIDIA Container Toolkit has not yet been validated with <a href="https://docs.docker.com/docker-for-windows/wsl/">Docker Desktop WSL 2</a> backendï¼ˆå®æµ‹å¯ä»¥è¿è¡Œï¼‰.</p>
<p><a href="">NVIDIA/nvidia-docker: Build and run Docker containers leveraging NVIDIA GPUs (github.com)</a></p>
</blockquote>
<p>å®‰è£…NVIDIA Dockerå·¥å…·åŒ…ï¼š</p>
<pre><code class="language-shell">distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg
curl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.list | \
sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list

sudo apt update &amp;&amp; sudo apt install -y nvidia-docker2
</code></pre>
<p>éœ€è¦é‡å¯dockeræœåŠ¡ä»¥å®Œæˆå®‰è£…ã€‚</p>
<p>å®¹å™¨ç¤ºä¾‹ï¼š</p>
<pre><code class="language-shell">docker run --gpus all nvcr.io/nvidia/k8s/cuda-sample:nbody nbody -gpu -benchmark
docker run -it --gpus all -p 8888:8888 tensorflow/tensorflow:latest-gpu-py3-jupyter
docker run --gpus all -it --shm-size=1g --ulimit memlock=-1 --ulimit stack=67108864 nvcr.io/nvidia/tensorflow:20.03-tf2-py3 # Unknown runtime specified nvidia.
</code></pre>
<h3 id="javaç¯å¢ƒ"><a class="header" href="#javaç¯å¢ƒ">Javaç¯å¢ƒ</a></h3>
<p><a href="https://spark.apache.org/mllib/">Spark MLlib</a></p>
<h2 id="æ•°æ®å‡†å¤‡"><a class="header" href="#æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</a></h2>
<p>å°½ç®¡å•ä¸ªå‘é‡çš„é»˜è®¤æ–¹å‘æ˜¯åˆ—å‘é‡ï¼Œä½†åœ¨è¡¨ç¤ºè¡¨æ ¼æ•°æ®é›†çš„çŸ©é˜µä¸­ï¼Œ å°†æ¯ä¸ªæ•°æ®æ ·æœ¬ä½œä¸ºçŸ©é˜µä¸­çš„è¡Œå‘é‡æ›´ä¸ºå¸¸è§ã€‚</p>
<ul>
<li>å‘é‡ï¼š$\mathbf{y}, \boldsymbol{y}$</li>
<li>çŸ©é˜µï¼š$\mathbf{A}, \boldsymbol{A}$</li>
<li>å¼ é‡ï¼š$\mathsf{X}$</li>
</ul>
<h3 id="æ•°æ®ç±»å‹"><a class="header" href="#æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></h3>
<ul>
<li>
<p><a href="../Python/Python%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html#%E7%9F%A9%E9%98%B5">Numpyæ•°ç»„</a></p>
</li>
<li>
<p><a href="Pytorch.html#Pytorch%E5%BC%A0%E9%87%8F">Pytorchå¼ é‡</a></p>
</li>
</ul>
<h3 id="æ•°æ®é›†åˆ’åˆ†"><a class="header" href="#æ•°æ®é›†åˆ’åˆ†">æ•°æ®é›†åˆ’åˆ†</a></h3>
<p>å°†æ•°æ®é›†æŒ‰æ¯”ä¾‹éšæœºæŠ½æ ·åˆ’åˆ†ä¸ºè®­ç»ƒé›†ã€å¼€å‘é›†ï¼ˆäº¤å‰éªŒè¯é›†ï¼‰å’Œæµ‹è¯•é›†ã€‚</p>
<ul>
<li><a href="ScikitLearn.html#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%92%E5%88%86">Scikit Learn</a></li>
</ul>
<blockquote>
<p>èƒ½åœ¨å¼€å‘é›†ä¸Šè¿è¡Œæ€§èƒ½è‰¯å¥½ï¼Œå´åœ¨æµ‹è¯•é›†ä¸Šæ•ˆæœä¸ä½³çš„ç³»ç»Ÿã€‚å¦‚æœæ­¤æ—¶å¼€å‘é›†å’Œæµ‹è¯•é›†çš„åˆ†å¸ƒç›¸åŒï¼Œé‚£ä¹ˆä½ å°±èƒ½æ¸…æ¥šåœ°æ˜ç™½é—®é¢˜æ‰€åœ¨ï¼šç®—æ³•åœ¨å¼€å‘é›†ä¸Šè¿‡æ‹Ÿåˆäº†ï¼ˆoverfitï¼‰ã€‚è§£å†³æ–¹æ¡ˆæ˜¾ç„¶å°±æ˜¯å»è·å–æ›´å¤šçš„å¼€å‘é›†æ•°æ®ã€‚</p>
<p>ä½†æ˜¯å¦‚æœå¼€å‘é›†å’Œæµ‹è¯•é›†æœä»ä¸åŒçš„åˆ†å¸ƒï¼Œè§£å†³æ–¹æ¡ˆå°±ä¸é‚£ä¹ˆæ˜ç¡®äº†ã€‚æ­¤æ—¶å¯èƒ½å­˜åœ¨ä»¥ä¸‹ä¸€ç§æˆ–è€…å¤šç§æƒ…å†µï¼š</p>
<ol>
<li>ç®—æ³•åœ¨å¼€å‘é›†ä¸Šè¿‡æ‹Ÿåˆäº†ã€‚</li>
<li>æµ‹è¯•é›†æ¯”å¼€å‘é›†æ›´éš¾è¿›è¡Œé¢„æµ‹ï¼Œå°½ç®¡ç®—æ³•åšå¾—è¶³å¤Ÿå¥½äº†ï¼Œå´å¾ˆéš¾æœ‰è¿›ä¸€æ­¥çš„æå‡ç©ºé—´ã€‚</li>
<li>æµ‹è¯•é›†ä¸ä¸€å®šæ›´éš¾é¢„æµ‹ï¼Œä½†å®ƒä¸å¼€å‘é›†æ€§è´¨å¹¶ä¸ç›¸åŒï¼ˆåˆ†å¸ƒä¸åŒï¼‰ã€‚å› æ­¤åœ¨å¼€å‘é›†ä¸Šè¡¨ç°è‰¯å¥½çš„ç®—æ³•ä¸ä¸€å®šåœ¨æµ‹è¯•é›†ä¸Šä¹Ÿèƒ½å¤Ÿå–å¾—å‡ºè‰²è¡¨ç°ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œå¤§é‡é’ˆå¯¹å¼€å‘é›†æ€§èƒ½çš„æ”¹è¿›å·¥ä½œå°†ä¼šæ˜¯å¾’åŠ³çš„ã€‚</li>
</ol>
<p><a href="https://deeplearning-ai.github.io/machine-learning-yearning-cn/docs/ch06/">å¼€å‘é›†å’Œæµ‹è¯•é›†åº”è¯¥æœä»åŒä¸€åˆ†å¸ƒ (deeplearning-ai.github.io)</a></p>
</blockquote>
<h3 id="çœŸå®æ•°æ®é›†"><a class="header" href="#çœŸå®æ•°æ®é›†">çœŸå®æ•°æ®é›†</a></h3>
<ul>
<li>
<p><code>keras.datasets</code></p>
<p>æä¾›åœ¨çº¿è·å–ï¼ˆç¼“å­˜åœ¨æœ¬åœ°<code>~/.keras/datasets/</code>ï¼‰å’ŒåŠ è½½ç¤ºä¾‹æ•°æ®é›†çš„æ¥å£ã€‚æ•°æ®é›†åŒ…æ‹¬ï¼š<code>mnist</code>ã€<code>boston_house</code>ã€<code>cifar</code>ã€<code>imdb</code>ã€<code>reuters</code>ç­‰ã€‚</p>
</li>
<li></li>
</ul>
<h2 id="æ•°æ®é¢„å¤„ç†"><a class="header" href="#æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</a></h2>
<ul>
<li>æ¸…ç†ï¼šé”™è¯¯ã€ä¸¢å¤±ä¿¡æ¯ï¼›</li>
<li>ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•ç†è§£æ•°æ®ï¼›</li>
<li>å¯è§†åŒ–æ•°æ®ï¼Œå‘ç°æœ‰ç”¨ç‰¹å¾ï¼›</li>
<li>æ„é€ æ–°ç‰¹å¾ï¼›</li>
<li>åå¤è¿­ä»£ï¼›</li>
</ul>
<h3 id="æ•°å€¼åŒ–numeralization"><a class="header" href="#æ•°å€¼åŒ–numeralization">æ•°å€¼åŒ–ï¼ˆNumeralizationï¼‰</a></h3>
<h4 id="ç±»åˆ«æ•°æ®categorical-variables"><a class="header" href="#ç±»åˆ«æ•°æ®categorical-variables">ç±»åˆ«æ•°æ®ï¼ˆ<em>Categorical Variables</em>ï¼‰</a></h4>
<ul>
<li><strong>æ— åºæ•°æ®</strong>ï¼ˆ<em><strong>nominal</strong></em>ï¼‰ï¼Œä¾‹å¦‚ï¼š<code>{male, female}</code>ï¼›ä¸åº”è¯¥è¢«ç¼–ç ä¸ºæ•°å€¼ï¼Œç±»åˆ«ä¹‹é—´æ— å¤§å°å…³ç³»ï¼›</li>
<li><strong>æœ‰åºæ•°æ®</strong>ï¼ˆ<em><strong>ordinal</strong></em>ï¼‰ï¼Œä¾‹å¦‚<code>{low, medium, high}</code>ï¼›å¯ä»¥ç¼–ç æˆä»»æ„å…·æœ‰å¤§å°å…³ç³»çš„æ•°å€¼ï¼Œä¸èƒ½å‡†ç¡®è¡¨ç¤ºåŸå§‹æ•°æ®çš„æ„å›¾ã€‚</li>
</ul>
<h5 id="one-hot-encoding-scheme"><a class="header" href="#one-hot-encoding-scheme">One-hot Encoding Scheme</a></h5>
<pre><code class="language-python">pd_dummy= pd.get_dummies(drop_first=True)
</code></pre>
<p>é»˜è®¤ä»…å¯¹<code>object</code>ç±»å‹çš„åˆ—è¿›è¡Œç¼–ç ã€‚</p>
<h6 id="dummy-variable-trap"><a class="header" href="#dummy-variable-trap">Dummy Variable Trap</a></h6>
<p>Multicollinearity: Variance Inflation Factor.</p>
<p>https://towardsdatascience.com/one-hot-encoding-multicollinearity-and-the-dummy-variable-trap-b5840be3c41a</p>
<h6 id="dummy-coding-scheme"><a class="header" href="#dummy-coding-scheme">Dummy Coding Scheme</a></h6>
<h6 id="effect-coding-scheme"><a class="header" href="#effect-coding-scheme">Effect Coding Scheme</a></h6>
<h5 id="bin-counting-scheme"><a class="header" href="#bin-counting-scheme">Bin-counting Scheme</a></h5>
<h5 id="feature-hashing-scheme"><a class="header" href="#feature-hashing-scheme">Feature Hashing Scheme</a></h5>
<ol>
<li>UNDERSTANDING FEATURE ENGINEERING (PART 2), Categorical Data, Strategies for working with discrete, categorical data, https://towardsdatascience.com/understanding-feature-engineering-part-2-categorical-data-f54324193e63.</li>
<li>scikit-learn 0.22.1, Preprocessing data, Discretization, https://scikit-learn.org/stable/modules/preprocessing.html#discretization.</li>
</ol>
<h4 id="word2vec"><a class="header" href="#word2vec">Word2vec</a></h4>
<p>åˆ©ç”¨One-hot Encodingè¡¨ç¤ºå•è¯ï¼Œä½¿ç”¨é™ç»´æ–¹æ³•å‡å°å‘é‡ç©ºé—´ã€‚</p>
<p><a href="https://www.jianshu.com/p/471d9bfbd72f">é€šä¿—ç†è§£word2vec - ç®€ä¹¦ (jianshu.com)</a></p>
<p><a href="https://www.cnblogs.com/peghoty/p/3857839.html">word2vec ä¸­çš„æ•°å­¦åŸç†è¯¦è§£ - peghoty - åšå®¢å›­ (cnblogs.com)</a></p>
<h4 id="æ ‡ç­¾ç¼–ç "><a class="header" href="#æ ‡ç­¾ç¼–ç ">æ ‡ç­¾ç¼–ç </a></h4>
<p>æ ‡ç­¾ç¼–ç ï¼Œå°†æ–‡æœ¬æ•°æ®è½¬æ¢ä¸ºæ•´æ•°ã€‚</p>
<blockquote>
<ul>
<li><a href="ScikitLearn.html#LabelEncoder"><code>sklearn.preprocessing.LabelEncoder</code></a></li>
</ul>
</blockquote>
<p>æ ‡ç­¾äºŒå€¼åŒ–ï¼Œå°†æ ·æœ¬çš„è´Ÿ/æ­£æ ‡ç­¾å€¼è½¬æ¢ä¸º<code>(0,1)</code>äºŒå€¼ã€‚å¦‚æœæ ‡ç­¾å€¼ç±»åˆ«è¶…è¿‡ä¸¤ç±»ï¼Œåˆ™åˆ†åˆ«å¯¹æ¯ç±»å€¼ï¼ˆè§†ä¸ºæ­£æ ·æœ¬ï¼Œæ˜ å°„ä¸º<code>1</code>ï¼‰æ‰§è¡ŒäºŒå€¼åŒ–ï¼ˆéæ­£æ ·æœ¬æ˜ å°„ä¸º<code>0</code>ï¼‰ã€‚</p>
<blockquote>
<ul>
<li><a href="ScikitLearn.html#LabelBinarizer"><code>sklearn.preprocessing.LabelBinarizer</code></a></li>
</ul>
</blockquote>
<p>å¤šæ ‡ç­¾äºŒå…ƒåŒ–ï¼Œæ ·æœ¬çš„æ¯ä¸ªæ ‡ç­¾å¯¹åº”çš„ç¼–ç ä½ç½®ä¸º1ã€‚</p>
<blockquote>
<ul>
<li><a href="ScikitLearn.html#MultiLabelBinarizer"><code>sklearn.preprocessing.MultiLabelBinarizer</code></a></li>
</ul>
</blockquote>
<h3 id="æ ‡å‡†åŒ–normalization"><a class="header" href="#æ ‡å‡†åŒ–normalization">æ ‡å‡†åŒ–ï¼ˆNormalizationï¼‰</a></h3>
<blockquote>
<p><em>Change the values of numeric columns in the dataset to a common scale, without distorting differences in the ranges of values.</em></p>
</blockquote>
<p>æ¯ä¸ªç‰¹å¾å…·æœ‰çš„ç‰©ç†æ„ä¹‰ä¸åŒï¼Œå…¶å…·ä½“æ•°å€¼åœ¨ç‰¹å¾ä¹‹é—´é€šå¸¸ä¸å…·æœ‰å¯æ¯”æ€§ï¼ˆæ›´æ¢æ•°æ®çš„å•ä½å…¶æ•°å€¼å°±ç›¸åº”åœ°ç¼©æ”¾ï¼Œä½†æ˜¯ç‰©ç†æ„ä¹‰æ²¡æœ‰å˜åŒ–ï¼‰ï¼›å°†æ•°æ®ç‰¹å¾çš„åŒºé—´ç¼©æ”¾åˆ°ä¸€ä¸ªå¸¸è§çš„èŒƒå›´ï¼Œæå‡ç®—æ³•ç¨³å®šæ€§ã€‚</p>
<p><strong>å¯¹äºåŸºäºè·ç¦»çš„ç®—æ³•ï¼Œåˆ™éœ€è¦è€ƒè™‘ï¼š1ï¼‰åŸå§‹æ•°æ®çš„å–å€¼èŒƒå›´ï¼ˆå•ä½ï¼‰æ˜¯å¦å½±å“ç®—æ³•ï¼›2ï¼‰æ ‡å‡†åŒ–æ˜¯å¦ç ´åäº†åŸå§‹çš„è·ç¦»ä¿¡æ¯ï¼›</strong></p>
<blockquote>
<p>å¦‚æœä¸€åˆ—æ•°æ®ä¸ºå¸¸é‡ï¼Œç¼©æ”¾æ–¹æ³•æ— æ•ˆï¼›åŒæ—¶ï¼Œè¯¥åˆ—æ•°æ®åœ¨å­¦ä¹ ä»»åŠ¡ä¸­é€šå¸¸æ²¡æœ‰ä½œç”¨ã€‚</p>
</blockquote>
<h4 id="çº¿æ€§ç¼©æ”¾"><a class="header" href="#çº¿æ€§ç¼©æ”¾">çº¿æ€§ç¼©æ”¾</a></h4>
<p>çº¿æ€§ç¼©æ”¾å¤„ç†ç‰¹å¾ä¹‹é—´æ•°æ®èŒƒå›´ä¸ä¸€è‡´çš„æƒ…å½¢ã€‚</p>
<h5 id="æ ‡å‡†ç¼©æ”¾standardscaler"><a class="header" href="#æ ‡å‡†ç¼©æ”¾standardscaler">æ ‡å‡†ç¼©æ”¾ï¼ˆStandardScalerï¼‰</a></h5>
<p>ç§»é™¤æ ·æœ¬çš„ç»Ÿè®¡å‡å€¼å¹¶å°†ç»Ÿè®¡æ–¹å·®ç¼©æ”¾ä¸º1ï¼š
$$
z = (x-\mu)/\sigma \notag
$$</p>
<h5 id="min-maxç¼©æ”¾"><a class="header" href="#min-maxç¼©æ”¾">Min-Maxç¼©æ”¾</a></h5>
<p>å°†ç‰¹å¾åŒºé—´ç¼©æ”¾åˆ°$[0,1]$åŒºé—´ã€‚
$$
\hat{x}=\frac{x-\min{x}}{\max{x}-\min{x}}\notag
$$</p>
<h4 id="éçº¿æ€§ç¼©æ”¾"><a class="header" href="#éçº¿æ€§ç¼©æ”¾">éçº¿æ€§ç¼©æ”¾</a></h4>
<h5 id="å¯¹æ•°ç¼©æ”¾logscaler"><a class="header" href="#å¯¹æ•°ç¼©æ”¾logscaler">å¯¹æ•°ç¼©æ”¾ï¼ˆLogScalerï¼‰*</a></h5>
<p>æ ·æœ¬ç‰¹å¾åˆ†å¸ƒ<a href="https://towardsdatascience.com/visualizing-data-with-pair-plots-in-python-f228cf529166">èŒƒå›´å¾ˆå¤§ï¼ˆé•¿å°¾åˆ†å¸ƒï¼‰</a>ï¼Œæ ¹æ®ç‰¹å¾çš„å±æ€§ï¼Œå¦‚æœåœ¨ç‰¹å¾å–å€¼è¾ƒå¤§ï¼Œè€Œå…¶å˜åŒ–å¯¹ç›®æ ‡ä»»åŠ¡å½±å“è¾ƒå°æ—¶ï¼ˆä¾‹å¦‚æ”¶å…¥ã€æ•°æ®ä¸‹è½½é‡ã€éŸ³é‡ç­‰ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨å¯¹æ•°ç¼©æ”¾ï¼Œä»è€Œä¿ç•™æ›´å¤šç‰¹å¾ä¿¡æ¯ã€‚</p>
<blockquote>
<p>å¯¹æ•°ç¼©æ”¾å¯èƒ½ä½¿å¾—å¼‚å¸¸ç‚¹ä¸æ˜¾è‘—ã€‚</p>
</blockquote>
<p>$$
\hat{x}=\log_{10}{(1+x)}\notag
$$</p>
<p>å¯ä»¥ä¸çº¿æ€§ç¼©æ”¾ç»“åˆä½¿ç”¨ã€‚</p>
<h3 id="å½’ä¸€åŒ–unit-vector-normalization"><a class="header" href="#å½’ä¸€åŒ–unit-vector-normalization">å½’ä¸€åŒ–ï¼ˆUnit Vector Normalizationï¼‰</a></h3>
<p>é’ˆå¯¹æ¯ä¸ªæ ·æœ¬è€Œä¸æ˜¯æ¯ä¸ªç‰¹å¾è¿›è¡Œå¤„ç†ã€‚</p>
<p>å°†å‘é‡ï¼ˆ<strong>æ ·æœ¬ç‰¹å¾å‘é‡</strong>ï¼‰é•¿åº¦ç¼©æ”¾ä¸º1ï¼Œå³å°†æ‰€æœ‰æ ·æœ¬ç¼©æ”¾åˆ°ä¸€ä¸ªå•ä½è¶…çƒé¢ä¸Šã€‚éœ€è¦æ³¨æ„ï¼Œ==å¦‚æœåŸå§‹æ•°æ®æœ¬èº«å…·æœ‰ä¸åŒçš„å‘é‡é•¿åº¦ï¼Œä¸”ç®—æ³•å¯¹æ•°æ®çš„å‘é‡é•¿åº¦æ•æ„Ÿ==ï¼ˆåŸºäºè·ç¦»çš„ç®—æ³•ï¼‰ï¼Œåˆ™æ­¤ç±»æ ‡å‡†åŒ–æ–¹æ³•ä¸é€‚ç”¨ã€‚æ­¤æ–¹æ³•å¸¸ç”¨äº<strong>æ–‡æœ¬åˆ†ç±»æˆ–èšç±»</strong>ã€‚
$$
\hat{\boldsymbol{x}}=\frac{\boldsymbol{x}}{|\boldsymbol{x}|}\notag
$$</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/preprocessing/plot_all_scaling.html#sphx-glr-auto-examples-preprocessing-plot-all-scaling-py">Compare the effect of different scalers on data with outliers</a>ã€‚</p>
<h3 id="ç‰¹å¾ç”Ÿæˆ"><a class="header" href="#ç‰¹å¾ç”Ÿæˆ">ç‰¹å¾ç”Ÿæˆ</a></h3>
<h4 id="å¤šé¡¹å¼ç‰¹å¾ç”Ÿæˆ"><a class="header" href="#å¤šé¡¹å¼ç‰¹å¾ç”Ÿæˆ">å¤šé¡¹å¼ç‰¹å¾ç”Ÿæˆ</a></h4>
<p>åŸºäºå·²æœ‰ç‰¹å¾ç”Ÿæˆé«˜é˜¶éçº¿æ€§ç‰¹å¾ï¼Œå¦‚ï¼š$x^2, x^3, xy, \cdots$ã€‚</p>
<h2 id="å¤„ç†æµç¨‹"><a class="header" href="#å¤„ç†æµç¨‹">å¤„ç†æµç¨‹</a></h2>
<h3 id="pipeline"><a class="header" href="#pipeline">Pipeline</a></h3>
<img src="Python.assets/pipeline.png" alt="img" style="zoom: 67%;" />
<p>å°†æ•°æ®é¢„å¤„ç†ã€å­¦ä¹ ç®—æ³•ç­‰æµç¨‹ä¸²è”èµ·æ¥ï¼ˆ<strong>æœ€åä¸€ä¸ªæµç¨‹å¿…é¡»æ‰§è¡Œé¢„æµ‹</strong>ï¼‰ã€‚</p>
<ul>
<li><a href="ScikitLearn.html#Pipeline%E5%B7%A5%E4%BD%9C%E6%B5%81">Scikit-Learn Pipeline</a></li>
</ul>
<h2 id="æ€§èƒ½è¯„ä¼°"><a class="header" href="#æ€§èƒ½è¯„ä¼°">æ€§èƒ½è¯„ä¼°</a></h2>
<h3 id="è¯„ä¼°æ–¹æ³•"><a class="header" href="#è¯„ä¼°æ–¹æ³•">è¯„ä¼°æ–¹æ³•ï¼š</a></h3>
<ul>
<li>
<p>å­¦ä¹ æ–¹æ³•ï¼ˆestimatorï¼‰çš„<code>score</code>æ–¹æ³•</p>
</li>
<li>
<p><code>sklearn.metrics</code>æä¾›çš„è¯„ä¼°é¢„æµ‹è¯¯å·®çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆ†ç±»è¯¯å·®è®¡ç®—æ–¹æ³•ï¼š<code>accuracy_score</code>ã€<code>f1_score</code>ã€<code>precision_score</code>ã€<code>recall_score</code>ï¼Œå›å½’è¯¯å·®è®¡ç®—æ–¹æ³•<code>r2_score</code>ã€‚</p>
</li>
<li>
<p>äº¤å‰éªŒè¯çš„è¯„åˆ†ç­–ç•¥ï¼Œé€šè¿‡<code>scoring</code>å‚æ•°é€‰æ‹©è¯„åˆ†æ–¹æ³•ã€‚è¯„åˆ†å™¨ï¼ˆ<code>scorer</code>ï¼‰çº¦å®šè¶Šé«˜è¯„åˆ†ä»£è¡¨è¶Šå¥½çš„æ€§èƒ½ã€‚é¢„å®šä¹‰çš„<code>scoring</code>å‚æ•°å¯¹åº”äº†<code>metrics</code>ä¸­çš„è¯„ä¼°æ–¹æ³•ã€‚</p>
<p><code>make_scorer</code></p>
<p>è‡ªå®šä¹‰æ‰“åˆ†æ–¹æ³•ï¼š</p>
<pre><code class="language-python">def scoring_func(estimator, X, y):
  # do scoring
  return score # higher is better.
</code></pre>
</li>
</ul>
<p>å¤šåˆ†ç±»æˆ–å¤šæ ‡ç­¾åˆ†ç±»çš„è¯„åˆ†æ–¹æ³•ã€‚</p>
<blockquote>
<p>å½“ä½ éœ€è¦åœ¨å¤šä¸ªåˆ†ç±»å™¨ä¹‹é—´è¿›è¡Œé€‰æ‹©æ—¶ï¼Œä½¿ç”¨å•å€¼è¯„ä¼°æŒ‡æ ‡å°†å¸®åŠ©ä½ æ›´å¿«é€Ÿåœ°ä½œå‡ºå†³å®šã€‚å®ƒèƒ½ç»™å‡ºä¸€ä¸ªæ¸…æ™°æ˜äº†çš„åˆ†ç±»å™¨æ€§èƒ½æ’åï¼Œä»è€Œå¸®åŠ©å›¢é˜Ÿæ˜ç¡®åç»­çš„æ”¹è¿›æ–¹å‘ã€‚</p>
<p><a href="https://deeplearning-ai.github.io/machine-learning-yearning-cn/docs/ch08/">ä½¿ç”¨å•å€¼è¯„ä¼°æŒ‡æ ‡è¿›è¡Œä¼˜åŒ– (deeplearning-ai.github.io)</a></p>
<p><a href="https://deeplearning-ai.github.io/machine-learning-yearning-cn/docs/ch09/">ä¼˜åŒ–æŒ‡æ ‡å’Œæ»¡æ„åº¦æŒ‡æ ‡ (deeplearning-ai.github.io)</a></p>
</blockquote>
<h3 id="äº¤å‰éªŒè¯"><a class="header" href="#äº¤å‰éªŒè¯">äº¤å‰éªŒè¯</a></h3>
<blockquote>
<p><em>Cross Validation (CV) provides the ability to estimate model performance on unseen data not used while training.</em></p>
</blockquote>
<ul>
<li>test on unseen data</li>
<li>avoid overfitting</li>
</ul>
<h5 id="kæŠ˜äº¤å‰éªŒè¯"><a class="header" href="#kæŠ˜äº¤å‰éªŒè¯">KæŠ˜äº¤å‰éªŒè¯</a></h5>
<p>æ­¥éª¤ï¼šsplitting the data into subsets (called folds, <strong>K-fold</strong>) and rotating the training and validation among them. </p>
<p><img src="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.assets/1rRqMSQZ38QKPWqf79GYQRQ.png" alt="K-fold" /></p>
<ul>
<li><a href="ScikitLearn.html#%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81">Scikit Learn</a></li>
</ul>
<p>https://towardsdatascience.com/what-is-cross-validation-60c01f9d9e75</p>
<p><a href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter">Metrics and scoring: quantifying the quality of predictions</a></p>
<h3 id="å‚æ•°æœç´¢"><a class="header" href="#å‚æ•°æœç´¢">å‚æ•°æœç´¢</a></h3>
<p>è·å–éè®­ç»ƒè¿‡ç¨‹è°ƒæ•´çš„ä½ å‚æ•°ã€‚</p>
<h5 id="ç½‘æ ¼æœç´¢äº¤å‰éªŒè¯"><a class="header" href="#ç½‘æ ¼æœç´¢äº¤å‰éªŒè¯">ç½‘æ ¼æœç´¢äº¤å‰éªŒè¯</a></h5>
<p>åœ¨å„ä¸ªè¶…å‚æ•°çš„å–å€¼èŒƒå›´å†…ç©·ä¸¾å‚æ•°ç»„åˆï¼Œåˆ†åˆ«åº”ç”¨äºæ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹ï¼Œæ ¹æ®é¢„æµ‹æ€§èƒ½è·å¾—æœ€ä½³çš„è¶…å‚æ•°ç»„åˆã€‚ä¸ºäº†è®¡ç®—åº”ç”¨è¶…å‚æ•°ç»„åˆçš„æ¨¡å‹çš„æ€§èƒ½ï¼Œéœ€è¦ç»“åˆ(KæŠ˜)äº¤å‰éªŒè¯ï¼Œå³å°†æ•°æ®é›†åˆ’åˆ†ä¸º==è®­ç»ƒé›†å’ŒéªŒè¯é›†==ã€‚</p>
<ul>
<li><a href="ScikitLearn.html#%E7%BD%91%E6%A0%BC%E6%90%9C%E7%B4%A2%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81"><code>GridSearchCV</code></a></li>
</ul>
<h5 id="random-search-cross-validation"><a class="header" href="#random-search-cross-validation">Random Search Cross Validation</a></h5>
<p>ä»å‚æ•°ç©ºé—´ä¸­éšæœºé‡‡æ ·ã€‚</p>
<ol>
<li><a href="https://scikit-learn.org/stable/modules/grid_search.html#">Tuning the hyper-parameters of an estimator</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">sklearn.model_selection.GridSearchCV</a></li>
</ol>
<h2 id="æ·±åº¦å­¦ä¹ ç®—æ³•"><a class="header" href="#æ·±åº¦å­¦ä¹ ç®—æ³•">æ·±åº¦å­¦ä¹ ç®—æ³•</a></h2>
<h3 id="autoencoder"><a class="header" href="#autoencoder">AutoEncoder</a></h3>
<p><a href="https://blog.keras.io/building-autoencoders-in-keras.html">Building Autoencoders in Keras, 2016</a></p>
<h2 id="end-to-end-ml-lifecycle-management"><a class="header" href="#end-to-end-ml-lifecycle-management">End-to-End ML Lifecycle Management</a></h2>
<h3 id="mlflow"><a class="header" href="#mlflow">MLflow</a></h3>
<ul>
<li><strong>MLflow Tracking</strong>: è®°å½•å®éªŒç»“æœï¼Œæ¯”è¾ƒå‚æ•°å’Œç»“æœï¼›</li>
<li><strong>MLflow Projects</strong>ï¼šå°†MLä»£ç æ‰“åŒ…æœªå¯é‡ç”¨å¯å¤ç°çš„å½¢å¼ï¼ˆç”¨äºå…±äº«æˆ–ç”Ÿäº§éƒ¨ç½²ï¼‰ï¼›</li>
<li><strong>MLflow Models</strong>ï¼šæ”¯æŒå¤šç§æœºå™¨å­¦ä¹ åº“æ¨¡å‹åœ¨å¤šç§å¹³å°ä¸Šçš„ç®¡ç†å’Œéƒ¨ç½²ï¼›</li>
<li><strong>MLflow Registry</strong>ï¼šæä¾›æ¨¡å‹ç®¡ç†åä½œä¸­å¿ƒã€‚</li>
</ul>
<p><a href="https://www.mlflow.org/docs/latest/concepts.html">Concepts â€” MLflow 1.24.0 documentation</a></p>
<p><a href="https://www.mlflow.org/docs/latest/tutorials-and-examples/index.html">Tutorials and Examples â€” MLflow 1.24.0 documentation</a></p>
<p><a href="https://github.com/mlflow/mlflow/tree/master/examples/multistep_workflow">Orchestrating Multistep Workflows</a></p>
<pre><code class="language-shell">conda create -n mlflow -c conda-forge mlflow
pip install mlflow
pip install mlflow[pipelines] # + experimental MLflow Pipelines
pip install mlflow[extras]    # + extra ML libraries and 3rd-party tools
pip install mlflow-skinny     # + lightweight version of MLflow
</code></pre>
<blockquote>
<p><em>MLflow requires <code>conda</code> to be on the <code>PATH</code> for the projects feature.</em></p>
</blockquote>
<h4 id="mlflow-tracking"><a class="header" href="#mlflow-tracking">MLflow Tracking</a></h4>
<p><a href="https://www.mlflow.org/docs/latest/tracking.html#tracking-server">MLflow Tracking â€” MLflow 1.24.0 documentation</a></p>
<h5 id="tracking-api"><a class="header" href="#tracking-api">Tracking API</a></h5>
<pre><code class="language-python">from mlflow import log_metric, log_param
mlflow.set_tracking_uri(&quot;http://YOUR-SERVER:4040&quot;)  # é»˜è®¤ä¸ºæœ¬åœ°æ–‡ä»¶å­˜å‚¨
mlflow.set_experiment(&quot;my-experiment&quot;) # å®éªŒåï¼Œé»˜è®¤ä¸ºDefault
log_param(&quot;param1&quot;, randint(0, 100))   # è®°å½•è¾“å…¥çš„å‚æ•°
log_metric(&quot;foo&quot;, random() + 2)        # è®°å½•è¾“å‡ºçš„æŒ‡æ ‡
</code></pre>
<p>ä¸ºä¸åŒçš„å®éªŒè®¾ç½®ä¸ç›¸åŒçš„å®éªŒåç§°ï¼Œä»è€Œæ–¹ä¾¿å¯¹æ¯”å®éªŒå‚æ•°å’Œè¾“å‡ºæŒ‡æ ‡ã€‚</p>
<p>é»˜è®¤å°†è¿è¡Œè®°å½•å†™å…¥æœ¬åœ°<code>./mlruns</code>ç›®å½•ï¼Œå¯åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡Œ<code>mlfllow ui</code>æŸ¥çœ‹å…¶ä¸­çš„è¿è¡Œè®°å½•ã€‚æ¯ä¸ªè¿è¡Œè®°å½•ç”±å”¯ä¸€çš„<strong>Run ID</strong>ã€‚</p>
<p><strong>Artifacts</strong>åŒ…å«æ¨¡å‹ä»£ç ã€è¿è¡Œç¯å¢ƒå£°æ˜ç­‰ä¿¡æ¯ã€‚</p>
<h4 id="mlflow-projects"><a class="header" href="#mlflow-projects">MLflow Projects</a></h4>
<pre><code class="language-shell">mlflow run --no-conda project_path -P param1=value1
</code></pre>
<p>å¦‚æœæŒ‡å®š<code>--no-conda</code>ï¼Œåˆ™MLflowä¸ä¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–ï¼ˆMLflowå†…éƒ¨ä¼šç»´æŠ¤è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨è€Œä¸ä¼šé‡å¤åˆ›å»ºï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨ç³»ç»Ÿå·²æœ‰ç¯å¢ƒã€‚</p>
<p>é¡¹ç›®å£°æ˜æ–‡ä»¶ï¼š</p>
<pre><code class="language-yaml">name: tutorial           # é¡¹ç›®åç§°
conda_env: conda.yaml    # é¡¹ç›®ä½¿ç”¨çš„è™šæ‹Ÿç¯å¢ƒé…ç½®
entry_points:            # ä»£ç å…¥å£ä¿¡æ¯
  main:                  # å¯å®šä¹‰å¤šä¸ªå…¥å£ï¼ŒæŒ‰é¡ºåºæŒ‡å®šï¼ˆæ„æˆå¤„ç†æµç¨‹ï¼‰
    parameters:          # ä»£ç æ¥æ”¶çš„å‚æ•°
      alpha: {type: float, default: 0.5}
      l1_ratio: {type: float, default: 0.1}
    command: &quot;python train.py {alpha} {l1_ratio}&quot;  # æ‰§è¡Œä»£ç çš„å‘½ä»¤
</code></pre>
<p>è™šæ‹Ÿç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="language-yaml">name: tutorial           # è™šæ‹Ÿç¯å¢ƒåç§°ï¼ˆMLflowå†…éƒ¨ä½¿ç”¨ï¼Œæ˜ å°„condaè™šæ‹Ÿç¯å¢ƒåç§°ï¼‰
channels:                # ä½¿ç”¨çš„è½¯ä»¶æºé€šé“
  - conda-forge
dependencies:            # ä¾èµ–åº“å£°æ˜
  - python=3.7
  - pip
  - pip:                 # éœ€è¦ä½¿ç”¨pipå®‰è£…çš„ä¾èµ–åº“
      - scikit-learn==0.23.2
      - mlflow&gt;=1.0
      - pandas
</code></pre>
<h5 id="sklearn"><a class="header" href="#sklearn">sklearn</a></h5>
<p><em>pandas, numpy, and sklearn</em></p>
<h4 id="mlflow-models"><a class="header" href="#mlflow-models">MLflow Models</a></h4>
<h5 id="ä¿å­˜æ¨¡å‹"><a class="header" href="#ä¿å­˜æ¨¡å‹">ä¿å­˜æ¨¡å‹</a></h5>
<pre><code class="language-shell">mlflow.log_artifacts(&quot;output_path&quot;)    # å°†æœ¬åœ°ç›®å½•ä¸­çš„å†…å®¹ä½œä¸ºæ¨¡å‹å†…å®¹ä¿å­˜
mlflow.sklearn.log_model(lr, &quot;model&quot;)  # å°†æ¨¡å‹å¯¹è±¡ä¿å­˜åˆ°æœ¬åœ°
</code></pre>
<h5 id="è¿è¡Œæ¨¡å‹"><a class="header" href="#è¿è¡Œæ¨¡å‹">è¿è¡Œæ¨¡å‹</a></h5>
<pre><code class="language-shell">mlflow models serve -m runs:/&lt;RUN_ID&gt;/model --port 5001
</code></pre>
<p>æ ¹æ®æ¨¡å‹è‡ªå¸¦çš„ç¯å¢ƒå£°æ˜è‡ªåŠ¨åˆ›å»ºCondaè™šæ‹Ÿç¯å¢ƒå¹¶è¿è¡Œæ¨¡å‹ã€‚æ¨¡å‹å¯åŠ¨åå¯ä»¥é€šè¿‡RESTæ¥å£å‘å…¶å‘é€æ•°æ®ã€‚æ¨¡å‹å°†æ‰§è¡Œé¢„æµ‹å¹¶è¾“å‡ºç»“æœã€‚</p>
<p>è¿è¡Œæ¨¡å‹ä½¿ç”¨çš„Pythonç‰ˆæœ¬å¿…é¡»ä¸åˆ›å»ºæ¨¡å‹æ—¶ä½¿ç”¨çš„ç‰ˆæœ¬ä¸€è‡´ï¼ˆå¦åˆ™<code>pickle</code>æ— æ³•æ­£å¸¸å·¥ä½œï¼‰ã€‚</p>
<h5 id="è¿è¡Œæ—¶æ£€æµ‹ä¾èµ–åº“"><a class="header" href="#è¿è¡Œæ—¶æ£€æµ‹ä¾èµ–åº“">è¿è¡Œæ—¶æ£€æµ‹ä¾èµ–åº“</a></h5>
<p><a href="https://www.mlflow.org/docs/latest/tutorials-and-examples/tutorial.html#specifying-pip-requirements-using-pip-requirements-and-extra-pip-requirements">specifying pip requirements using <code>pip_requirements</code> and <code>extra_pip_requirements</code></a></p>
<h3 id="ray"><a class="header" href="#ray">Ray</a></h3>
<p>ğŸ“š<a href="https://docs.ray.io/en/latest/ray-air/user-guides.html">User Guides â€” Ray 2.0.0</a></p>
<h4 id="å®‰è£…"><a class="header" href="#å®‰è£…">å®‰è£…</a></h4>
<h5 id="æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒæ¶æ„"><a class="header" href="#æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒæ¶æ„">æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒæ¶æ„</a></h5>
<p><img src="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.assets/ray-air.svg" alt="" /></p>
<ul>
<li>
<p><a href="https://docs.ray.io/en/latest/data/dataset.html#data-compatibility">Ray Datasets: Distributed Data Preprocessing â€” Ray 2.0.0</a></p>
</li>
<li>
<p>Ray Train: Scalable Model Training</p>
</li>
<li>
<p>Tune: Scalable Hyperparameter Tuning</p>
</li>
<li>
<p>Serve: Scalable and Programmable Serving</p>
</li>
<li>
<p>RLlib: Industry-Grade Reinforcement Learning</p>
</li>
</ul>
<blockquote>
<p><em>Ray Datasets is designed to load and preprocess data for distributed ML training pipelines.</em></p>
</blockquote>
<p><img src="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.assets/air-ecosystem.svg" alt="AIR ecosystem map" /></p>
<blockquote>
<p><a href="https://docs.ray.io/en/latest/ray-air/air-ecosystem.html#air-ecosystem-map">AIR ecosystem map</a>.</p>
</blockquote>
<h5 id="å®‰è£…æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒ"><a class="header" href="#å®‰è£…æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒ">å®‰è£…æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒ</a></h5>
<pre><code class="language-python">conda create -n ray-ml python=3.10
pip install 'ray[air]'                # åŒ…å«æœºå™¨å­¦ä¹ è¿è¡Œç¯å¢ƒçš„æ‰€æœ‰æ¨¡å—
pip install tqdm                      # tqdmç”¨äºæ˜¾ç¤ºæ•°æ®å¤„ç†è¿›åº¦
pip install fastapi                   # ç”¨äºæ¨¡å‹éƒ¨ç½²æä¾›API
pip install xgboost xgboost_ray torch tensorflow  
</code></pre>
<p>Rayé›†æˆçš„æœºå™¨å­¦ä¹ æ¡†æ¶ä»¥åŠå…¶ä»–å·¥å…·éœ€è¦ç‹¬ç«‹å®‰è£…ã€‚</p>
<h4 id="æ•°æ®é¢„å¤„ç†-1"><a class="header" href="#æ•°æ®é¢„å¤„ç†-1">æ•°æ®é¢„å¤„ç†</a></h4>
<p>åŠ è½½å¹¶æ‹†åˆ†æ•°æ®é›†ï¼Œæ„é€ è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•é›†ã€‚</p>
<pre><code class="language-python">dataset = ray.data.read_csv(&quot;s3://anonymous@air-example-data/breast_cancer.csv&quot;)
train_dataset, valid_dataset = dataset.train_test_split(test_size=0.3)
test_dataset = valid_dataset.drop_columns(cols=[&quot;target&quot;])
</code></pre>
<blockquote>
<p>Rayä¼šè‡ªåŠ¨åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªé›†ç¾¤ï¼Œå¯é€šè¿‡ä»ªè¡¨æ¿æŸ¥çœ‹ï¼ˆ<code>http://127.0.0.1:8265</code>ï¼‰ã€‚</p>
</blockquote>
<p>æ„é€ é¢„å¤„ç†å™¨ï¼Œå¦‚æ ‡å‡†åŒ–ç­‰ï¼›</p>
<pre><code class="language-python">from ray.data.preprocessors import StandardScaler
preprocessor = StandardScaler(columns=[&quot;mean radius&quot;, &quot;mean texture&quot;])
</code></pre>
<h5 id="é¢„å¤„ç†å™¨"><a class="header" href="#é¢„å¤„ç†å™¨">é¢„å¤„ç†å™¨</a></h5>
<p>é¢„å¤„ç†å¤„ç†æ ‡å‡†çš„æ•°æ®é›†å¯¹è±¡<code>DataSet</code>ã€‚é¢„å¤„ç†å™¨åœ¨è®­ç»ƒé˜¶æ®µè¿›è¡Œæ‹Ÿåˆï¼ˆ<code>fit_transform</code>ï¼‰å¹¶åº”ç”¨äºè®­ç»ƒå’ŒæœåŠ¡é˜¶æ®µï¼ˆ<code>transform</code>ï¼‰ã€‚</p>
<p>è‡ªå®šä¹‰é¢„å¤„ç†å™¨ï¼š</p>
<pre><code class="language-python">import ray
from pandas import DataFrame
from ray.data.preprocessor import Preprocessor
from ray.data import Dataset
from ray.data.aggregate import Max

class CustomPreprocessor(Preprocessor):
    def _fit(self, dataset: Dataset) -&gt; Preprocessor:
        self.stats_ = dataset.aggregate(Max(&quot;value&quot;))
    def _transform_pandas(self, df: DataFrame) -&gt; DataFrame:
        return df * self.stats_[&quot;max(value)&quot;]
</code></pre>
<p>ä½¿ç”¨<code>BatchMapper</code>æ„é€ æ— éœ€æ‹Ÿåˆçš„é¢„å¤„ç†</p>
<pre><code class="language-python">preprocessor = BatchMapper(lambda df: df * 2)
</code></pre>
<h4 id="è®­ç»ƒæ¨¡å‹"><a class="header" href="#è®­ç»ƒæ¨¡å‹">è®­ç»ƒæ¨¡å‹</a></h4>
<p>é€‰æ‹©å¸¸ç”¨æœºå™¨å­¦ä¹ æ¡†æ¶è®­ç»ƒæ¨¡å‹ã€‚æ­¤é˜¶æ®µé€šå¸¸éœ€è¦è¾“å…¥è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†ä»¥ä¼˜åŒ–æ¨¡å‹ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p>
<pre><code class="language-python">from ray.air.config import ScalingConfig
from ray.train.xgboost import XGBoostTrainer
trainer = XGBoostTrainer(...)
result = trainer.fit()
print(result.metrics)
</code></pre>
<h4 id="è¶…å‚æ•°è°ƒä¼˜"><a class="header" href="#è¶…å‚æ•°è°ƒä¼˜">è¶…å‚æ•°è°ƒä¼˜</a></h4>
<pre><code class="language-python">from ray import tune
param_space = {&quot;params&quot;: {&quot;max_depth&quot;: tune.randint(1, 9)}}
metric = &quot;train-logloss&quot;

from ray.tune.tuner import Tuner, TuneConfig
from ray.air.config import RunConfig
tuner = Tuner(trainer,param_space=param_space,tune_config=TuneConfig(**kwargs))
result_grid = tuner.fit()
# Fetch the best result.
best_result = result_grid.get_best_result()
print(&quot;Best Result:&quot;, best_result)
</code></pre>
<h4 id="ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹"><a class="header" href="#ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹">ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹</a></h4>
<h5 id="checkpoints"><a class="header" href="#checkpoints">Checkpoints</a></h5>
<p><code>Checkpoint</code>å¯¹è±¡ç”±è®­ç»ƒå™¨ã€è°ƒä¼˜å™¨ä»¥åŠé¢„è®­ç»ƒæ¨¡å‹ç”Ÿæˆï¼Œç”¨äºæ„å»ºæ¨¡å‹å¯¹è±¡ã€‚</p>
<h5 id="æ‰¹é‡é¢„æµ‹"><a class="header" href="#æ‰¹é‡é¢„æµ‹">æ‰¹é‡é¢„æµ‹</a></h5>
<pre><code class="language-python">from ray.train.batch_predictor import BatchPredictor
from ray.train.xgboost import XGBoostPredictor
# You can also create a checkpoint from a trained model using
# `XGBoostCheckpoint.from_model`.
checkpoint = best_result.checkpoint
batch_predictor = BatchPredictor.from_checkpoint(checkpoint, XGBoostPredictor)
predicted_probabilities = batch_predictor.predict(test_dataset)
predicted_probabilities.show()
</code></pre>
<h4 id="æ¨¡å‹éƒ¨ç½²"><a class="header" href="#æ¨¡å‹éƒ¨ç½²">æ¨¡å‹éƒ¨ç½²</a></h4>
<pre><code class="language-shell">from ray import serve
from fastapi import Request
from ray.serve import PredictorDeployment
from ray.serve.http_adapters import json_request


async def adapter(request: Request):
    content = await request.json()
    print(content)
    return pd.DataFrame.from_dict(content)

serve.start(detached=True)
deployment = PredictorDeployment.options(name=&quot;XGBoostService&quot;)
deployment.deploy(
    XGBoostPredictor, result.checkpoint, batching_params=False, http_adapter=adapter
)
print(deployment.url)
</code></pre>
<pre><code class="language-shell">import requests
sample_input = test_dataset.take(1)
sample_input = dict(sample_input[0])
output = requests.post(deployment.url, json=[sample_input]).json()
print(output)
</code></pre>
<h2 id="å‚è€ƒæ–‡çŒ®"><a class="header" href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></h2>
<ol>
<li><a href="https://github.com/Nyandwi/machine_learning_complete">Nyandwi/machine_learning_complete: A comprehensive machine learning repository containing 30+ notebooks on different concepts, algorithms and techniques. (github.com)</a></li>
<li><a href="https://deeplearning-ai.github.io/machine-learning-yearning-cn/docs/ch04/">è§„æ¨¡é©±åŠ¨æœºå™¨å­¦ä¹ å‘å±• (deeplearning-ai.github.io)</a></li>
<li><a href="https://github.com/deeplearning-ai/machine-learning-yearning-cn/">deeplearning-ai/machine-learning-yearning-cn: Machine Learning Yearning ä¸­æ–‡ç‰ˆ - ã€Šæœºå™¨å­¦ä¹ è®­ç»ƒç§˜ç±ã€‹ - Andrew Ng è‘— (github.com)</a></li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../åº”ç”¨è½¯ä»¶/å¤šåª’ä½“ç¼–è¾‘è½¯ä»¶.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../æœºå™¨å­¦ä¹ /ScikitLearn.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../åº”ç”¨è½¯ä»¶/å¤šåª’ä½“ç¼–è¾‘è½¯ä»¶.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../æœºå™¨å­¦ä¹ /ScikitLearn.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../theme/pagetoc.js"></script>
        <script type="text/javascript" src="../theme/MathJax.js"></script>
    </body>
</html>