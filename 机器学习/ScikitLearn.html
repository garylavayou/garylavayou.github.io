<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>scikit-learn - Learning Programming Book</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The example book covers examples.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/pagetoc.css">
        <!-- MathJax -->
        <!-- <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        <script async type="text/javascript" src="theme/MathJax.js"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../prefix.html">Prefix</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">程序设计语言</li><li class="chapter-item expanded "><a href="../Python/Python编程基础.html">Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Python/Python编程基础.html">编程基础</a></li><li class="chapter-item expanded "><a href="../Python/Python开发环境.html">开发环境</a></li><li class="chapter-item expanded "><a href="../Python/Python数据类型.html">数据类型</a></li><li class="chapter-item expanded "><a href="../Python/Python输入输出.html">输入输出</a></li><li class="chapter-item expanded "><a href="../Python/Python编程应用.html">编程应用</a></li><li class="chapter-item expanded "><a href="../Python/Python数值计算.html">数值计算</a></li><li class="chapter-item expanded "><a href="../Python/Python系统编程.html">系统编程</a></li><li class="chapter-item expanded "><a href="../Python/Python高级编程.html">高级编程</a></li></ol></li><li class="chapter-item expanded "><a href="../Java/JAVA编程基础.html">Java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Java/JAVA编程基础.html">编程基础</a></li><li class="chapter-item expanded "><a href="../Java/Java开发环境.html">开发环境</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Java/Maven POM.html">Maven 配置</a></li></ol></li><li class="chapter-item expanded "><a href="../Java/JAVA数据类型.html">数据类型</a></li><li class="chapter-item expanded "><a href="../Java/JAVA输入输出.html">输入输出</a></li><li class="chapter-item expanded "><a href="../Java/JAVA系统编程.html">系统编程</a></li><li class="chapter-item expanded "><a href="../Java/Scala.html">Scala</a></li><li class="chapter-item expanded "><a href="../Java/ScalaFrameworks.html">Scala 框架</a></li></ol></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharp编程基础.html">C#/.NET</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CSharp.NET/CSharp编程基础.html">编程基础</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharp输入输出.html">输入输出</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharp数据容器.html">数据容器</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/CSharp数值计算.html">数值计算</a></li><li class="chapter-item expanded "><a href="../CSharp.NET/dotnet开发.html">.NET 开发</a></li></ol></li><li class="chapter-item expanded "><a href="../CC++/Modern C++.html">C and C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CC++/Modern C++.html">Modern C++</a></li><li class="chapter-item expanded "><a href="../CC++/C++开发环境.html">开发环境</a></li><li class="chapter-item expanded "><a href="../CC++/C++容器.html">数据容器</a></li><li class="chapter-item expanded "><a href="../CC++/输入输出.html">输入输出</a></li><li class="chapter-item expanded "><a href="../CC++/标准函数库.html">标准库</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../CC++/数学函数.html">数学函数</a></li></ol></li></ol></li><li class="chapter-item expanded "><div>Web开发</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../JavaScript/JavaScript.html">JavaScript</a></li><li class="chapter-item expanded "><a href="../JavaScript/TypeScript.html">TypeScript</a></li><li class="chapter-item expanded "><a href="../JavaScript/JS开发环境.html">开发环境</a></li></ol></li><li class="chapter-item expanded "><div>开发工具</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../开发环境/git.html">Git</a></li><li class="chapter-item expanded "><a href="../笔记/正则表达式.html">正则表达式</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">操作系统</li><li class="chapter-item expanded "><a href="../Linux/Linux配置和管理.html">Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Linux/Linux配置和管理.html">配置管理</a></li><li class="chapter-item expanded "><a href="../Linux/Linux-Shell.html">Shell Script</a></li><li class="chapter-item expanded "><a href="../Linux/Linux发行版.html">Linux 发行版</a></li><li class="chapter-item expanded "><a href="../Linux/操作系统原理.html">操作系统原理</a></li></ol></li><li class="chapter-item expanded "><a href="../Windows/Windows配置管理.html">Windows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Windows/Windows配置管理.html">配置管理</a></li><li class="chapter-item expanded "><a href="../Windows/Windows Shell.html">Shell</a></li><li class="chapter-item expanded "><a href="../Windows/Windows Applications.html">应用软件</a></li></ol></li><li class="chapter-item expanded "><div>应用软件</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../应用软件/程序开发软件.html">程序开发</a></li><li class="chapter-item expanded "><a href="../应用软件/服务器管理软件.html">服务器管理</a></li><li class="chapter-item expanded "><a href="../应用软件/网络访问软件.html">网络访问</a></li><li class="chapter-item expanded "><a href="../应用软件/网络服务软件.html">网络服务</a></li><li class="chapter-item expanded "><a href="../应用软件/文档生成软件.html">文档生成</a></li><li class="chapter-item expanded "><a href="../应用软件/文件处理软件.html">文件处理</a></li><li class="chapter-item expanded "><a href="../应用软件/协作办公软件.html">协作办公</a></li><li class="chapter-item expanded "><a href="../应用软件/知识管理软件.html">知识管理</a></li><li class="chapter-item expanded "><a href="../应用软件/多媒体编辑软件.html">多媒体编辑</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">机器学习</li><li class="chapter-item expanded "><a href="../机器学习/机器学习实践.html">机器学习实践</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../机器学习/ScikitLearn.html" class="active">scikit-learn</a></li><li class="chapter-item expanded "><a href="../机器学习/TensorFlow.html">TensorFlow</a></li><li class="chapter-item expanded "><a href="../机器学习/Pytorch.html">Pytorch</a></li><li class="chapter-item expanded "><a href="../机器学习/图神经网络.html">图神经网络</a></li></ol></li><li class="chapter-item expanded "><a href="../机器学习/机器学习原理与算法.html">原理与算法</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../机器学习/统计学习算法.html">统计学习算法</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">数据库</li><li class="chapter-item expanded "><a href="../数据库/SQL语法.html">SQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../数据库/SQL DDL.html">SQL DDL</a></li><li class="chapter-item expanded "><a href="../数据库/SQL DML.html">SQL DML</a></li><li class="chapter-item expanded "><a href="../数据库/SQL数据类型.html">数据类型</a></li></ol></li><li class="chapter-item expanded "><a href="../数据库/MySQL.html">MySQL</a></li><li class="chapter-item expanded "><a href="../数据库/PostgreSQL.html">PostgreSQL</a></li><li class="chapter-item expanded "><a href="../数据库/HiveSQL.html">Hive SQL</a></li><li class="chapter-item expanded "><a href="../数据库/Elasticsearch.html">Elasticsearch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../数据库/Elastic Datasource.html">数据源</a></li></ol></li><li class="chapter-item expanded "><a href="../数据库/Mongodb.html">Mongodb</a></li><li class="chapter-item expanded "><a href="../数据库/GraphDatabase.html">图数据库</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">服务和大数据平台</li><li class="chapter-item expanded "><a href="../服务器/分布式大数据处理.html">分布式大数据处理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../服务器/CDH6大数据集群离线安装.html">CDH6 安装教程</a></li><li class="chapter-item expanded "><a href="../服务器/Spark Python API.html">Pyspark</a></li><li class="chapter-item expanded "><a href="../服务器/流数据处理.html">流数据处理</a></li></ol></li><li class="chapter-item expanded "><a href="../服务器/容器编排.html">容器编排</a></li><li class="chapter-item expanded "><a href="../服务器/虚拟化.html">虚拟化</a></li><li class="chapter-item expanded "><div>任务编排</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../服务器/Airflow.html">Airflow</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">其他</li><li class="chapter-item expanded "><div>数据标记语言</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../数据交换语言/JSON and YAML.html">JSON and YAML</a></li><li class="chapter-item expanded "><a href="../数据交换语言/XML.html">XML</a></li><li class="chapter-item expanded "><a href="../数据交换语言/HTML.html">HTML</a></li></ol></li><li class="chapter-item expanded "><div>网络协议</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Protocols/http.html">HTTP</a></li><li class="chapter-item expanded "><a href="../Protocols/DNS.html">DNS</a></li><li class="chapter-item expanded "><a href="../Protocols/端口分配.html">端口分配</a></li><li class="chapter-item expanded "><a href="../Protocols/IP protocol numbers.html">IP 承载协议</a></li><li class="chapter-item expanded "><a href="../Protocols/RPC.html">RPC</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Learning Programming Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <h1 id="scikit-learn"><a class="header" href="#scikit-learn">Scikit Learn</a></h1>
<h2 id="数据准备"><a class="header" href="#数据准备">数据准备</a></h2>
<h3 id="数据集划分"><a class="header" href="#数据集划分"><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.html#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%92%E5%88%86">数据集划分</a></a></h3>
<pre><code class="language-python">from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(
    df_data,             # 支持DataFrame输出DataFrame, 可省略.to_numpy()
    df_target,           # support 1d array/series
    test_size=0.25, random_state=1
)
</code></pre>
<h2 id="数据预处理"><a class="header" href="#数据预处理">数据预处理</a></h2>
<h3 id="数值化"><a class="header" href="#数值化">数值化</a></h3>
<h4 id="特征编码"><a class="header" href="#特征编码">特征编码</a></h4>
<h5 id="one-hot-encoder"><a class="header" href="#one-hot-encoder">One-Hot Encoder</a></h5>
<p><code>OneHotEncoder</code>可以利用数据训练得到数据的取值集合，随后用于新数据的编码（<code>fit</code>、<code>transform</code>）；而<code>pd.get_dummies</code>仅能对当前数据进行编码（<code>fit_transform</code>）。</p>
<pre><code class="language-python">from sklearn.preprocessing import OneHotEncoder
enc = OneHotEncoder(categories='auto', drop=None, sparse=True, 
                    dtype=np.float64, handle_unknown='error')
</code></pre>
<p><code>categories</code>：指定离散数据的类型。默认为<code>'auto'</code>，编码器从数据中推导每个特征包含的类别（<code>fit()</code>）；反之，可以为每一列指定离散值（<code>list_of_list</code>，每个特征对应的类别数量可能不同，不适合使用矩阵表示），==每一列的值不应该混合字符串和数值；如果为数值类型，则应该有序==。</p>
<p><code>drop</code>：默认保留编码后的所有列，<code>first</code>：丢弃第一列，去除冗余；<code>if_binary</code>：仅对有两类的列丢弃第一列。</p>
<p><code>sparse</code>：如果设置为<code>True</code>，则在执行<code>transform</code>时，要求数据也是稀疏类型的。</p>
<p><code>enc.categories_</code>：拟合后得到的类别数据取值集合（<code>enc.categories</code>为初始化的集合）。</p>
<p><code>enc.get_feature_names(col_names)</code>：根据原数据列名（<code>col_names</code>为序列类型），生成编码后数据列名；==需要首先执行<code>fit()</code>操作==，<code>fit()</code>返回的是编码后的数值矩阵，可结合生成的列名构建编码后的表格（<code>pd.DataFrame</code>）。</p>
<h4 id="标签编码"><a class="header" href="#标签编码"><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.html#%E6%A0%87%E7%AD%BE%E7%BC%96%E7%A0%81">标签编码</a></a></h4>
<h5 id="labelencoder"><a class="header" href="#labelencoder"><code>LabelEncoder</code></a></h5>
<ul>
<li>
<p><code>fit</code>：统计标签类别；</p>
</li>
<li>
<p><code>transform</code>：将标签根据已知类别进行数字编码。<code>fit_transform</code>：在相同数据上进行类别学习和编码。</p>
</li>
</ul>
<h5 id="labelbinarizer"><a class="header" href="#labelbinarizer"><code>LabelBinarizer</code></a></h5>
<p><code>fit(y)</code>/<code>transform(y)</code>/<code>fit_transform(y)</code>：从<code>y</code>（序列类型）中统计标签的类别，标签按数值/字符串大小排序。</p>
<blockquote>
<p><code>fit</code>决定拟合的类别数量<code>n_classes</code>；<code>transform</code>根据输入决定标签类型：<code>y_type=multiclass/binary/...'</code></p>
</blockquote>
<ul>
<li>
<p>普通情况：拟合数据包含两类（==从小到大==分别为<code>neg_label</code>, <code>pos_label</code>），变换数据包含相同的一类/两类；则对变换数据根据<code>y</code>中二值对应进行编码；由于负标签和正标签总是按拟合数据的大小顺序确定的，因此如果与认为规定的正负标签不一致，可对变换后的编码求反：<code>y=1-y</code>。</p>
</li>
<li>
<p><strong>标签正交二值化</strong>（<code>'multiclass'</code>）：如果<code>fit</code>或<code>transform</code>的数据<code>y</code>至少包含两类，且总类别数超过两类；则将拟合数据<code>y</code>中的每类数值单独进行二值编码，不同类别的标签变换后的编码相互正交。</p>
<pre><code class="language-python">lb.fit(['a', 'b', 'c'])
lb.transform(['c','b','a','d'])
# input l_a l_b l_c    # fit -&gt; a b c
#   c    0   0   1     # 对应类型标签列的值为1，其余为0
#   b    0   1   0
#   a    1   0   0
#   d    0   0   0     # 不属于任何一类 
</code></pre>
</li>
<li>
<p>如果拟合数据只有一类（通常不应该出现），如果变换数据包含除拟合类别外的数值，则将拟合类别视为正类别；<em>如果变换数据也只包含拟合类别，视拟合类别为负类别</em>（即该列为常量，应该剔除）。</p>
</li>
</ul>
<pre><code class="language-python">lb.fit(['b', 'a'])  # 记录拟合的标签 ['a','b']
lb.classes_         # 按大小顺序，与出现顺序无关
y = lb.transform(['a', 'b', 'b','a']) # -&gt;[0, 1, 1, 0]
y = lb.transform(['a', 'b', 'c','a']) # -&gt;[[1,0], [0,1], [0,0], [1,0]]
</code></pre>
<blockquote>
<p>标签二值编码的计算实现：</p>
<pre><code class="language-python">y = column_or_1d(y)  
# pick out the known labels from y
y_in_classes = np.in1d(y, classes) # Test whether each element of a 1-D array is also 
                                   # present in a second array.
y_seen = y[y_in_classes]
indices = np.searchsorted(sorted_class, y_seen) # Find indices where elements should be 
                                                # inserted to maintain order.
                                                # 此处等效查找y的分类序号
indptr = np.hstack((0, np.cumsum(y_in_classes))) # if y_in_classes, then it has 1
                                                 # corresp. index.
data = np.empty_like(indices)
data.fill(pos_label)                            
Y = sp.csr_matrix((data, indices, indptr),      # 每一行只有一个非零元素（只属于一类）
                  shape=(n_samples, n_classes)) # 因此适用于csr_matrix
</code></pre>
</blockquote>
<h5 id="multilabelbinarizer"><a class="header" href="#multilabelbinarizer"><code>MultiLabelBinarizer</code></a></h5>
<p>与<code>LabelBinarizer</code>存在超过两类的情况不同在于，==每个样本可以拥有多个标签，样本标签可以有交集，因此样本二值编码后并不一定相互正交==。如果每个样本仅包含一个标签，则等价于<code>LabelBinarizer</code>。</p>
<pre><code class="language-python">mlb.fit_transform([{'sci-fi', 'thriller'}, {'comedy'}])
# array([[0, 1, 1],
#       [1, 0, 0]])
mlb.classes_
# array(['comedy', 'sci-fi', 'thriller'], dtype=object)
</code></pre>
<p>每个样本的多个标签应该用列表，元组或集合表示。</p>
<blockquote>
<p>上述示例中，总共包括三类标签，记录的类别按标签字典序排序。所以第一个标签样本编码后为<code>011</code>，第二个标签样本编码为<code>100</code>。</p>
</blockquote>
<h3 id="特征生成"><a class="header" href="#特征生成">特征生成</a></h3>
<h5 id="多项式特征生成"><a class="header" href="#多项式特征生成">多项式特征生成</a></h5>
<pre><code class="language-python">from sklearn.preprocessing import PolynomialFeatures
pf = PolynomialFeatures(degree=2)
X_train = pf.fit_transform(X_train)  # 生成所有特征的所有二阶及以下多项式组合特征
</code></pre>
<h3 id="特征尺度变换"><a class="header" href="#特征尺度变换">特征尺度变换</a></h3>
<p><code>StandardScaler</code></p>
<p><code>MinMaxScaler</code></p>
<p><code>Normalizer(norm='l2', copy=True)</code></p>
<h2 id="机器学习流程"><a class="header" href="#机器学习流程">机器学习流程</a></h2>
<pre><code class="language-python">steps = [
  ('proc_name', estimator), 
  ...
]
workflow = Pipeline(steps)
pred = workflow.fit(x)		# fit transform/predict
pipe.score(x,y)
pipe['proc_name'].func_name()
</code></pre>
<p>流程的参数可以通过<code>Pipeline.set_params</code>进行修改，也可以<strong>对每个流程的对象单独修改</strong>。</p>
<p>为了与<code>Pipeline</code>保持兼容，相应处理流程需要提供三个参数（<code>self,x,y=None</code>），对于预处理流程第三个参数不起作用。</p>
<h3 id="机器学习算法模型"><a class="header" href="#机器学习算法模型">机器学习算法模型</a></h3>
<h4 id="模型参数"><a class="header" href="#模型参数">模型参数</a></h4>
<pre><code class="language-python">estimator.get_params()
</code></pre>
<h3 id="pipeline工作流"><a class="header" href="#pipeline工作流">Pipeline工作流</a></h3>
<h4 id="featureunion"><a class="header" href="#featureunion">FeatureUnion</a></h4>
<p>多个转换流程并行处理所有数据，并将转换结果合并。</p>
<h4 id="columntransformer"><a class="header" href="#columntransformer">ColumnTransformer</a></h4>
<p>对数据特征执行并行处理，并将结果合并。</p>
<pre><code class="language-python">colunm_trans = ColumnTransformer[
  [('proc_name', proc, idx), ...]
]
</code></pre>
<p><code>proc</code>：可以是具体的对象，或是<code>'passthrough'</code>、<code>'drop'</code>。</p>
<p>Ignored. This parameter exists only for compatibility with <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline"><code>sklearn.pipeline.Pipeline</code></a>.</p>
<h2 id="性能评估"><a class="header" href="#性能评估">性能评估</a></h2>
<h3 id="交叉验证"><a class="header" href="#交叉验证"><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5.html#%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81">交叉验证</a></a></h3>
<pre><code class="language-python">from sklearn.model_selection import KFold
kf = KFold(n_split=5)
X_train = [None]*5 # X_test = X_train.copy() ...
# 通过迭代依次交换训练/测试集
for train_index, test_index in kf.split(X):
  X_train[i], X_test[i] = X[train_index], X[test_index]
  y_train[i], y_test[i] = y[train_index], y[test_index]
</code></pre>
<h3 id="参数搜索"><a class="header" href="#参数搜索">参数搜索</a></h3>
<h4 id="网格搜索交叉验证"><a class="header" href="#网格搜索交叉验证">网格搜索交叉验证</a></h4>
<pre><code class="language-python">from sklearn.model_selection import GridSearchCV
cv = GridSearchCV(estimator, param_grid, scoring=None,jobs=None,cv=None)
cv.fit(data, label)
</code></pre>
<p>参数网格定义：可定义一个或多个参数组合。</p>
<pre><code class="language-python"># 使用字典代表参数网格
param_grid = {'kernel': ('linear', 'rbf'), 'C': [1, 10]}
# 使用字典的列表代表多个参数网格
param_grid = [{'kernel': ['rbf'], 'gamma': [1e-3, 1e-4], 'C': [1, 10, 100]},
              {'kernel': ['linear'], 'C': [1, 10, 100, 1000]}]
</code></pre>
<p>交叉验证参数<code>cv</code>：</p>
<ul>
<li><code>None</code>：默认使用5折交叉验证；</li>
<li><code>N</code>：N折交叉验证；</li>
<li><code>CV splitter</code>：</li>
<li>一个返回<code>(train,test)</code>数据的迭代器。</li>
</ul>
<p>计算结果包括：</p>
<ul>
<li>
<p><code>cv_results_</code>：各个参数组合及其评估性能结果；</p>
</li>
<li>
<p><code>best_estimator_</code>：通过搜索得到的性能最好的模型实例；</p>
</li>
<li>
<p><code>best_score_</code></p>
</li>
<li>
<p><code>best_params_</code></p>
</li>
<li>
<p><code>best_index_</code>：最佳结果在<code>cv_results_</code>中的索引；</p>
</li>
<li></li>
</ul>
<h4 id="随机搜索交叉验证"><a class="header" href="#随机搜索交叉验证">随机搜索交叉验证</a></h4>
<p><code>RandomizedSearchCV</code></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../机器学习/机器学习实践.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../机器学习/TensorFlow.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../机器学习/机器学习实践.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../机器学习/TensorFlow.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../theme/pagetoc.js"></script>
        <script type="text/javascript" src="../theme/MathJax.js"></script>
    </body>
</html>